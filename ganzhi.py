#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# Author: ?????pythontesting ???21734177 ????qq?:630011153 144081101
# CreateDate: 2019-2-21
import datetime
from collections import OrderedDict
from bidict import bidict

Gan = ["?", "?", "?", "?", "?", "?", "?", "?", "?", "?"]

Zhi = ["?", "?", "?", "?", "?", "?", "?", "?", "?", "?", "?", "?"]

datouxiu = ("??", "??", "??", "??", "??", "??", "??", "??")

xiaotouxiu = ("??", "??", "??", "??", "??", "??")

temps = {"?":3, "?":1, "?":6, "?":4, "?":5, "?":-4, "?":-1, "?":-3, "?":-5, "?":-6,"?":-6, "?":-4, "?":3, "?":1, "?":-4, 
            "?":5, "?":6, "?":3, "?":-2, "?":-3,"?":4, "?":-5}


zhi_time = {"?":'23-1', "?":'1-3', "?":'3-5', "?":'5-7', "?":'7-9', 
            "?":'9-11', "?":'11-13', "?":'13-15', "?":'15-17', "?":'17-19',
            "?":'19-21', "?":'21-23'}

zhengs = "????"

wuhangs = {
    '?':"????",
    '?':"????",    
    '?':"????",
    '?':"????",     
    '?':"??????",         
}

ganzhi60 = bidict({
    1:"??", 13:"??", 25:"??", 37:"??", 49:"??", 2:"??", 14:"??", 26:"??", 38:"??", 50:"??", 
    3:"??", 15:"??", 27:"??", 39:"??", 51:"??", 4:"??", 16:"??", 28:"??", 40:"??", 52:"??", 
    5:"??", 17:"??", 29:"??", 41:"??", 53:"??", 6:"??", 18:"??", 30:"??", 42:"??", 54:"??", 
    7:"??", 19:"??", 31:"??", 43:"??", 55:"??", 8:"??", 20:"??", 32:"??", 44:"??", 56:"??", 
    9:"??", 21:"??", 33:"??", 45:"??", 57:"??", 10:"??", 22:"??", 34:"??", 46:"??", 58:"??", 
    11:"??", 23:"??", 35:"??", 47:"??", 59:"??", 12:"??", 24:"??", 36:"??", 48:"??", 60:"??"})


zhi5 = {
    "?":OrderedDict({"?":8}), 
    "?":OrderedDict({"?":5, "?":2, "?":1,}), 
    "?":OrderedDict({"?":5, "?":2, "?":1, }),
    "?":OrderedDict({"?":8}),
    "?":OrderedDict({"?":5, "?":2, "?":1, }),
    "?":OrderedDict({"?":5, "?":2, "?":1,}),
    "?":OrderedDict({"?":5, "?":3, }),
    "?":OrderedDict({"?":5, "?":2, "?":1,}),
    "?":OrderedDict({"?":5, "?":2, "?":1, }),
    "?":OrderedDict({"?":8}),
    "?":OrderedDict({"?":5, "?":2, "?":1 }),
    "?":OrderedDict({"?":5, "?":3, })}

zhi5_list = {
    "?":["?"], 
    "?":["?", "?", "?"], 
    "?":["?", "?", "?"],
    "?":["?"],
    "?":["?", "?", "?"],
    "?":[ "?", "?", "?"],
    "?":["?", "?"],
    "?":["?", "?", "?"],
    "?":["?", "?", "?"],
    "?":["?"],
    "?":["?", "?", "?" ],
    "?":["?", "?",]}

ShX = ["?", "?", "?", "?", "?", "?", "?", "?", "?", "?", "?", "?"]
numCn = ["?", "?", "?", "?", "?", "?", "?", "?", "?", "?", "?"]
Week = ["?", "?", "?", "?", "?", "?", "?"]
jqmc = ["??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??","??", "??", "??", "??", "??", "??", "??"]
jis = {0:'?', 1:'?', 2:'?', 3:'?', 4:'?'}
ymc = ["??", "??", "?", "?", "?", "?", "?", "?", "?", "?", "?", "?" ]
rmc = ["??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??", "??"]


ten_deities = {
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_', 
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?',"?":'?', "?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',"?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?',"?":'?', "?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',"?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':''}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?',"?":'?',"?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':''}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',"?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}), 
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',"?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}),
    '?':bidict({'?':'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?',"?":'?', "?":'?', 
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', "?":'?',
                  "?":'?', "?":'?', "?":'?', "?":'?', "?":'?', '?':'?_',
                  '?':'?', '?':'?', '??':'?', '??':'?', '?':'?','?':'?','?':'?'}), 

}

ju = {
    '?':'?', '??':'?',  '?':'?', '?':'?', '??':'?',
}

shengxiaos = bidict({
    "?":"?", "?":"?", "?":"?", "?":"?", "?":"?", "?":"?", 
    "?":"?", "?":"?", "?":"?", "?":"?", "?":"?", "?":"?"})


zhi_atts = {
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"?",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"?",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"?",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"?",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"?",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"",},
    "?":{"?":"?", "?":"?", "??":"?", "?":("?","?"), "?":("?","?"), '?':'?', '?':'?', "?":"?","?":"?",},
}




kus = {'?':"??", '?':'??', '?':'?', '?':'?',}

gan_hes = {
    ("?", "?"): "???? ?? ????,??????????????????,?????",
    ("?", "?"): '''??????? ????, ????,????,?????''',
    ("?", "?"): '''??????? ''',
    ("?", "?"): '''??????? ''',    
    ("?", "?"): '''???????''',    
}

gan_chongs = {("?", "?"): "??",   ("?", "?"): "??",
              ("?", "?"): "??", ("?", "?"): "??",}    

chongs = { 
    "?":"?", "?":"?","?":"?", "?":"?","?":"?", "?":"?", "?":"?",
    "?":"?", "?":"?", "?":"?", "?":"?", "?":"?", "?":"?",  "?":"?", 
    "?":"?",  "?":"?", "?":"?", "?":"?", "?":"?", "?":"?"
}


zhi_6hes = {
    "??": "?",
    "??": "?",
    "??": "?",
    "??": "?",    
    "??": "?",    
    "??": "?",        
}

zhi_3hes = {"???": "? ?","???": "? ?",  "???": "? ?", "???": "? ?"}
gong_he = {"??": '?', "??": '?', "??": '?', "??": '?',
           "??": '?', "??": '?', "??": '?', "??": '?',}

zhi_half_3hes = {
    ("?", "?"): "??  ???",
    ("?", "?"): "??  ???",
    ("?", "?"): "??  ???",    
    ("?", "?"): "?? ???",  
    ("?", "?"): "?? ???",  
    ("?", "?"): "?? ???",      
    ("?", "?"): "?? ???",    
    ("?", "?"): "?? ???",   
    ("?", "?"): "?? ???",   
    ("?", "?"): "?? ???",
    ("?","?"): "?? ???",
    ( "?", "?"): "?? ???",
}

zhi_hes = {
    "???": "?",
    "???": "?",  
    "???": "?", 
    "???": "?"
}

zhi_huis = {
    "???": "?",
    "???": "?",  
    "???": "?",       
    "???": "?",
}
gong_hui = {"??": '?', "??": '?', "??": '?', "??": '?',
           "??": '?', "??": '?', "??": '?', "??": '?',}

zhi_chongs = {
    ("?", "?"): "??",
    ("?", "?"): "??",
    ("?", "?"): "??",
    ("?", "?"): "??",
    ("?", "?"): "??",   
    ("?", "?"): "??",       
}

zhi_poes = {
    ("?", "?"): "??",
    ("?", "?"): "??",
    #("?", "?"): "??", 
    #("?", "?"): "??",
    ("?", "?"): "??",   
    ("?", "?"): "??",       
}

zhi_haies = {
    ("?", "?"): '''
    ??? ????,????,??????????????
    ???????????????,????????''',
    ("?", "?"): '''
    ??? ?????????,??????????,??????????????? 
    ??,?????,????;????????????????? ????,????;
    ????????????''',
    ("?", "?"): '''
    ???? ????????,???,???;????????,?????,???????
    ???????, ???;?????????????''',
    ("?", "?"): '''
    ??? ?????????,????????????,?????????????? 
    ??,?????,????;????????????????? ????,????;
    ????????????''',
    ("?", "?"): '''
    ???? ?????,????,?????????,??????,???????? 
    ????????,???,???;????????,?????,???????
    ???????, ???;?????????????''',   
    ("?", "?"): '''
    ??? ????????,?????,???????,??????;
    ???????,????,????,????? ??,???,???;????,?????
    ??? ????,????,????,???????????? ???''',       
}

zhi_xings = {
    ("?", "?"): "??? ???? ",
    ("?", "?"): "??? ????",
    ("?", "?"): "??? ????",
    ("?", "?"): "??? ????",
    ("?", "?"): "??? ????",   
    ("?", "?"): "??? ????",  
    ("?", "?"): "??????? ???? ????,???? ??????,????,????,????;???????,????,???,???,?????????????,????;????;???????,?????",       
}

xings = {"?":"?", "?":"?",  "?":"?", "?":"?", "?":"?", "?":"?",
         "?":"?", "?":"?", '?':'?', '?':'?','?':'?', '?':'?'}

zhi_zixings = ['?', '?', '?', '?']



gan5 = {"?":"?", "?":"?", "?":"?", "?":"?", "?":"?", "?":"?", 
        "?":"?", "?":"?", "?":"?", "?":"?"}

zhi_wuhangs = {"?":"?", "?":"?", "?":"?", "?":"?", "?":"?", "?":"?", 
        "?":"?", "?":"?", "?":"?", "?":"?", "?":"?", "?":"?"}

relations = {
    ("?", "?"): '=', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '',
    ("?", "?"): '=', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '',
    ("?", "?"): '=', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '',    
    ("?", "?"): '=', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '',
    ("?", "?"): '=', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '', ("?", "?"): '',

}

guans = {
    "?":('?',"?","?","?"), "?":('?',"?",'?'), "?":("?",'?','?'), 
    "?":('?',"?", '?'),"?":('?',"?","?","?"), "?":('?',"?", "?"), 
    "?":('?',"?", "?","?"), "?":('?',"?",'?'),
    "?":('?',"?",'?','?'), "?":('?',"?","?",'?','?','?'),}


gan_desc = {
    "?":'''?? ?? ??;????????????;???????,??,????,???''', 
    "?":'''? ? ?? ????  ????''', 
    "?":"? ? ?? ????", 
    "?":"? ? ?? ???? ???. ???,??????,????,????,????,?",
    "?":"?? ? ?? ???? ????????,?????????;?????????", 
    "?":"??? ?? ?? ????  ????,???? ???,???,???,????????,???,?????", 
    "?":"? ? ?? ??? ???? ??????? ???? ???? ?????,????, ??,??,?????",
    "?":"? ? ?? ???? ????,???, ??,???????????", 
    "?":"??? ? ?? ????", 
    "?":"? ?? ?? ?? ???? ?????, ?????????????,????"}

zhi_desc = {
    "?":"?? ?? ?????,??????,???????,???????",
    "?":"?? ??????,?????,????",
    "?":"?? ????????,???????? ????",
    "?":"?? ?? ?? ?? ???????,????????,????",
    "?":"?? ???? ?????????????",
    "?":"?? ??????,????,???????",
    "?": "?? ? ????,???? ????,????????,???????",
    "?": "?? ????,? ???;????,??????????,??????? ???;??????,??,??????,??????? ",
    "?":"?? ????;????? ??,?????",
    "?":"?? ?? ???,???????",
    "?": "?? ??????????? ???? ????",
    "?":"?? ??? ????????,??????",    
}

gan3 = {
    "?":'???,?????', 
    "?":'???,?????', 
    "?":'???,???', 
    "?":"???,?????",
    "?":"???,?????", 
    "?":"???,?????", 
    "?":"??,?????",
    "?":"???,?????", 
    "?":"???,?????", 
    "?":"???,?????"}

gan4 = {
    "?":'???', 
    "?":'???', 
    "?":'???', 
    "?":"???",
    "?":"???", 
    "?":"???", 
    "?":"???",
    "?":"???", 
    "?":"???", 
    "?":"???"}


zhi3 = {
    "?":"???",
    "?":"???",
    "?":"???",
    "?":"???",
    "?":"???",
    "?":"???",
    "?": "???",
    "?": "??? ",
    "?":"???",
    "?":"???",
    "?": "???",
    "?":"???", }


def getGZ(gzStr):
    import sxtwl
    tg = -1
    dz = -1
    for i, v in enumerate(Gan):
        if gzStr[0]  == v:
            tg = i
            break

    for i, v in enumerate(Zhi):
        if  gzStr[1] == v:
            dz = i
            break   
    return sxtwl.GZ(tg, dz)

def get_jizhu(gan, zhi):
    
    gan_index = Gan.index(gan)
    zhi_index = Zhi.index(zhi) 
    result = {}
    alls = []
    for i in range(6):
        ganzhi = "{}{}".format(Gan[(gan_index-6-i*9 )%10], Zhi[(zhi_index-6-i*9)%12])
        result[ganzhi] = get_year_of_ganzhi(ganzhi)
        alls += result[ganzhi]
    alls.sort()
    result['all'] = alls
    return result

def get_year_of_ganzhi(ganzhi):
    
    seq = ganzhi60.inverse[ganzhi]
    year = 1983 + seq
    current_year = get_current_year()
    result = [year - 60]
    if year <=  current_year:
        result.append(year)
    return result  

def get_current_year():
    
    current_date = datetime.date.today()
    return current_date.year

gan_health = {
    "?":'''
    ?????
    ???????????????
    ????????????
    
    ?????
    ?????????
    ??????????
    ???????????
    ???????
    ???????????
    ???????
    ?????????
    ???????
    ???????????
    ???,??????????, ?
    ???????????????????
    ??????????''',
                                     
    "?":'''
    ?????????????
    ???????????????
    ????????????
    ?????
    ?????????
    ??????????
    ???????????
    ??????
    ???????????
    ???????
    ?????????
    ???????
    ???????????
    ???????,???,????????????????
    ?????????????????????
    ???????????''',
                                        
    "?":'''
    ??????: ??????(????) ???
    ?????????
    ???????????????
    ????????????
    ???????
    ?????????
    ??????????
    ???????????
    ??????????
    ???????????
    ???????
    ?????????
    ???????,??????
    ???????????
    ???,??????
    ?????????????????????
    ???????????''',    
                                        
    "?":'''
    ?????????
    ???????????????
    ????????????
    ???????
    ?????????
    ??????????
    ???????????
    ??????
    ???????????
    ???????
    ?????????
    ???????
    ???????????
    ???,?????????????????
    ????????????????????
    ??????????''',
    
    "?":'''
    ?????????????????
    ?????????????????????
    ???????????????????????
    ??????????????
    ??????????
    ?????????,??????
    ????????
    ??????????
    ????????,??????
    ????????????
    ??????,??? 
    ?????,???????????
    ?????????????????????????
    ??????????''',      
}

# ??????????????,??????????????
mu_years = { '??': '?', '??': '??','??': '??','??': '?', '??': '?',
    
}